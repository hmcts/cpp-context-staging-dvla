{
  "$schema": "http://json-schema.org/draft-04/schema#",
  "id": "http://justice.gov.uk/cpp/stagingdvla/event/driver-notified.json",
  "description": "The details required to generate a now document",
  "type": "object",
  "properties": {
    "identifier": {
      "$ref": "http://justice.gov.uk/domain/core/common/definitions.json#/definitions/uuid"
    },
    "masterDefendantId": {
      "$ref": "http://justice.gov.uk/domain/core/common/definitions.json#/definitions/uuid"
    },
    "retrySequence": {
      "type": "integer"
    },
    "orderDate": {
      "type": "string",
      "format": "date"
    },
    "amendmentDate": {
      "type": "string",
      "format": "date"
    },
    "convictionDate": {
      "description": "This is attribute is not used , as the convictionDate in subschema defendantCaseOffence is used",
      "type": "string",
      "format": "date"
    },
    "materialId": {
      "$ref": "http://justice.gov.uk/domain/core/common/definitions.json#/definitions/uuid"
    },
    "orderingHearingId": {
      "description": "The identifier of the hearing that ordered this NOW",
      "$ref": "http://justice.gov.uk/domain/core/common/definitions.json#/definitions/uuid"
    },
    "emailNotifications": {
      "description": "The email notifications required to be sent for this document",
      "type": "array",
      "items": {
        "$ref": "http://justice.gov.uk/core/courts/notification/email-channel.json"
      }
    },
    "orderingCourt": {
      "$ref": "http://justice.gov.uk/core/courts/courtCentre.json"
    },
    "orderingCourtCode": {
      "type": "string"
    },
    "licenceProducedInCourt": {
      "type": "string"
    },
    "defendant": {
      "$ref": "http://justice.gov.uk/core/courts/nowdocument/nowdefendant.json"
    },
    "caseApplicationReferences": {
      "type": "array",
      "items": {
        "type": "string"
      }
    },
    "cases": {
      "title": "cases",
      "type": "array",
      "items": {
        "$ref": "#/definitions/prosecutionCase"
      }
    },
    "courtApplications": {
      "title": "courtApplications",
      "type": "array",
      "items": {
        "$ref": "#/definitions/courtApplication"
      }
    },
    "notificationWasPreviouslySent": {
      "type": "boolean"
    },
    "removedEndorsements": {
      "type": "array",
      "items": {
        "type": "string"
      }
    },
    "updatedEndorsements": {
      "type": "array",
      "items": {
        "type": "string"
      }
    },
    "distinctPrompts": {
      "type": "array",
      "title": "distinctPrompts",
      "items": {
        "$ref": "#/definitions/prompt"
      }
    },
    "previous": {
      "$ref": "#/definitions/now"
    },
    "resetNotificationHistory": {
      "type": "boolean",
      "description": "Indicates that this becomes latest DVLA notification and will be used as orginal for future amendments. This happens when application is amened to refuse DVLA endorsments"
    }
  },
  "required": [
    "orderDate",
    "orderingCourt",
    "defendant",
    "caseApplicationReferences",
    "cases"
  ],
  "definitions": {
    "now": {
      "type": "object",
      "properties": {
        "identifier": {
          "$ref": "http://justice.gov.uk/domain/core/common/definitions.json#/definitions/uuid"
        },
        "masterDefendantId": {
          "$ref": "http://justice.gov.uk/domain/core/common/definitions.json#/definitions/uuid"
        },
        "retrySequence": {
          "type": "integer"
        },
        "orderDate": {
          "type": "string",
          "format": "date"
        },
        "amendmentDate": {
          "type": "string",
          "format": "date"
        },
        "convictionDate": {
          "type": "string",
          "format": "date"
        },
        "materialId": {
          "$ref": "http://justice.gov.uk/domain/core/common/definitions.json#/definitions/uuid"
        },
        "orderingHearingId": {
          "description": "The identifier of the hearing that ordered this NOW",
          "$ref": "http://justice.gov.uk/domain/core/common/definitions.json#/definitions/uuid"
        },
        "emailNotifications": {
          "description": "The email notifications required to be sent for this document",
          "type": "array",
          "items": {
            "$ref": "http://justice.gov.uk/core/courts/notification/email-channel.json"
          }
        },
        "orderingCourt": {
          "$ref": "http://justice.gov.uk/core/courts/courtCentre.json"
        },
        "licenceProducedInCourt": {
          "type": "string"
        },
        "defendant": {
          "$ref": "http://justice.gov.uk/core/courts/nowdocument/nowdefendant.json"
        },
        "caseApplicationReferences": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "cases": {
          "title": "cases",
          "type": "array",
          "items": {
            "$ref": "#/definitions/prosecutionCase"
          }
        },
        "notificationWasPreviouslySent": {
          "type": "boolean"
        },
        "distinctPrompts": {
          "type": "array",
          "title": "prompts",
          "items": {
            "$ref": "#/definitions/prompt"
          }
        }
      },
      "required": [
        "orderDate",
        "orderingCourt",
        "defendant",
        "caseApplicationReferences",
        "cases"
      ],
      "additionalProperties": false
    },
    "prosecutionCase": {
      "type": "object",
      "properties": {
        "reference": {
          "type": "string"
        },
        "caseId": {
          "$ref": "http://justice.gov.uk/domain/core/common/definitions.json#/definitions/uuid"
        },
        "initiationCode": {
          "type": "string"
        },
        "caseStatus": {
          "type": "string"
        },
        "defendantCaseOffences": {
          "type": "array",
          "title": "defendantCaseOffences",
          "items": {
            "$ref": "#/definitions/defendantCaseOffence"
          }
        },
        "hasSV": {
          "type": "boolean"
        }
      },
      "required": [
        "reference",
        "defendantCaseOffences"
      ],
      "additionalProperties": false
    },
    "courtApplication": {
      "type": "object",
      "properties": {
        "applicationReference": {
          "type": "string"
        },
        "applicationStatus": {
          "type": "string"
        },
        "applicationType": {
          "type": "string"
        },
        "applicationTypeId": {
          "type": "string"
        },
        "applicationCode": {
          "type": "string"
        },
        "applicationReceivedDate": {
          "type": "string",
          "format": "date"
        },
        "id": {
          "$ref": "http://justice.gov.uk/domain/core/common/definitions.json#/definitions/uuid"
        },
        "results": {
          "type": "array",
          "title": "results",
          "items": {
            "$ref": "#/definitions/result"
          }
        }
      },
      "required": [
        "applicationReference",
        "id"
      ],
      "additionalProperties": false
    },
    "defendantCaseOffence": {
      "type": "object",
      "properties": {
        "title": {
          "type": "string"
        },
        "mainOffenceCode": {
          "type": "string"
        },
        "civilOffence": {
          "description": "Indicates that the offence is a civil matter rather than a criminal one",
          "type": "boolean"
        },
        "startDate": {
          "description": "The start date of the offence",
          "type": "string",
          "format": "date"
        },
        "endDate": {
          "description": "The end date of the offence",
          "type": "string",
          "format": "date"
        },
        "convictionDate": {
          "description": "Indicates that prosecution of this offence has led to a criminal conviction.  Not relevant for civil cases",
          "type": "string"
        },
        "convictingCourtCode": {
          "type": "string"
        },
        "convictionStatus": {
          "description": "Indicates the status of a conviction.  Null when offence is civil.  Not Convicted when there is not a conviction date.  Otherwise Convicted",
          "type": "string"
        },
        "plea": {
          "description": "The plea entered against the offence",
          "type": "string"
        },
        "vehicleRegistration": {
          "description": "The vehicle registration relevant to the offence",
          "type": "string"
        },
        "code": {
          "type": "string"
        },
        "dvlaCode": {
          "description": "The dvla code for the offence e.g. SP50",
          "type": "string"
        },
        "modeOfTrial": {
          "type": "string"
        },
        "allocationDecision": {
          "type": "string"
        },
        "wording": {
          "type": "string"
        },
        "alcoholReadingAmount": {
          "type": "string"
        },
        "alcoholReadingMethodCode": {
          "type": "string"
        },
        "alcoholReadingMethodDescription": {
          "type": "string"
        },
        "endorsableFlag": {
          "type": "boolean"
        },
        "results": {
          "type": "array",
          "title": "results",
          "items": {
            "$ref": "#/definitions/result"
          }
        },
        "fine": {
          "type": "string"
        },
        "penaltyPoints": {
          "type": "string"
        },
        "disqualificationPeriod": {
          "type": "string"
        },
        "otherSentence": {
          "type": "string"
        },
        "suspendedSentence": {
          "type": "string"
        },
        "dttpDtetp": {
          "type": "string"
        },
        "interimImposedFinalSentence": {
          "type": "string"
        },
        "sentencingCourtCode": {
          "type": "string"
        },
        "sentenceDate": {
          "type": "string",
          "format": "date"
        },
        "dateFromWhichDisqRemoved": {
          "type": "string"
        },
        "dateDisqSuspendedPendingAppeal": {
          "type": "string"
        },
        "dateDisqReimposedFollowingAppeal": {
          "type": "string"
        }
      },
      "additionalProperties": false
    },
    "result": {
      "type": "object",
      "properties": {
        "label": {
          "type": "string"
        },
        "resultIdentifier": {
          "type": "string"
        },
        "nowRequirementText": {
          "type": "array",
          "description": "A collection of all the now requirement text items for now requirements associated to the given result",
          "title": "nowRequirementTextItems",
          "items": {
            "$ref": "http://justice.gov.uk/core/courts/nowdocument/now-text.json"
          }
        },
        "publishedForNows": {
          "description": "Determines that when this result published it is published for NOWs only and not for LAA, Court Extract & SPI",
          "type": "boolean"
        },
        "prompts": {
          "type": "array",
          "title": "prompts",
          "items": {
            "$ref": "#/definitions/prompt"
          }
        },
        "resultWording": {
          "type": "string"
        },
        "resultDefinitionGroup": {
          "description": "The result definition group for filtering purposes",
          "type": "string"
        },
        "sequence": {
          "type": "number"
        },
        "d20": {
          "description": "Determines that the result is a D20 result",
          "type": "boolean"
        },
        "pointsDisqualificationCode": {
          "type": "string"
        },
        "drivingTestStipulation": {
          "type": "integer"
        },
        "dvlaCode": {
          "type": "string"
        }
      },
      "required": [
        "label"
      ],
      "additionalProperties": false
    },
    "prompt": {
      "type": "object",
      "properties": {
        "label": {
          "type": "string"
        },
        "welshLabel": {
          "type": "string"
        },
        "value": {
          "type": "string"
        },
        "welshValue": {
          "type": "string"
        },
        "promptIdentifier": {
          "type": "string"
        },
        "promptReference": {
          "type": "string"
        },
        "durationSequence": {
          "description": "Determines if the prompt is describing the primary, secondary or tertiary duration in the duration element",
          "type": "number",
          "maximum": 9
        }
      },
      "required": [
        "label"
      ],
      "additionalProperties": false
    }
  },
  "additionalProperties": false
}